<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
   <meta name="generator" content="BBEdit 6.1.2">
   <meta name="GENERATOR" content="Mozilla/4.77 (Macintosh; U; PPC) [Netscape]">
   <title>Install</title>
</head>
<body bgcolor="#FFFFFF">

<h3>
OME Installation notes:</h3>

<ul>
<li>
Copy the contents of the src/perl directory to where your perl CGI scripts
live.</li>

<br>Make sure Apache-mod-perl is properly configured to execute perl scripts
in this directory (/OME/perl in this example).  A sample perl handler section (within the Aliases section) might look like:<pre>
  Alias /perl/  "/OME/perl/"
    &lt;Location /perl&gt;
        SetHandler  perl-script
        PerlHandler Apache::Registry
        PerlScript 
        Options +ExecCGI
    &lt;/Location&gt;

    &lt;Files ~ "\.pl"&gt;
        SetHandler  perl-script
        PerlHandler Apache::Registry
        Options +ExecCGI
    &lt;/Files&gt;
</pre>
<br>You can check that everything is OK by pointing a browser at the script perl/ShowEnvCGI.pl 
(i.e. http://my.ome.server/perl/ShowEnvCGI.pl), and looking
at the GATEWAY_INTERFACE variable, which should be set to CGI-Perl/1.1.
<br>N.B.:  In the Perl handler section of Apache config, PerlSendHeader must be set to Off, which is the default.  
PERL_SEND_HEADER should not appear in the list of variables reported by http://my.ome.server/perl/ShowEnvCGI.pl
<br>After Apache is set up and mod_perl is functioning properly, make sure you have all of the OME perl dependencies
by running the perlCheck script as the root user from the installed perl directory (/OME/perl in this example):
<pre>> cd /OME/perl
> ./perlCheck.pl</pre>
At this point, you should re-start Apache.  Sending HUP to Apache and its kin is not always sufficient.
<li>
Copy the contents to src/JavaScript somewhere where they will not be executed
by a CGI handler.</li>

Same with the images.<br>
Usually my document-root looks something like:
<pre>
html
	JavaScript
	images
</pre>

<li>
Decide where you want to keep the java, SQL, and C stuff.&nbsp; So far
I've put things in a top level OME directory like so:</li>

<pre>
/OME
	C
	SQL
	java
	bin
	psql
	perl
</pre>
<li>
Go to the C directory, and do (as root):<br><ul><pre>
>make all
>make install
</pre></ul></li>

<li>
You need to create the directories /var/tmp/OME, /var/tmp/OME/lock, /var/tmp/OME/sessions</li>

<li>
create the ome database:</li>
<ul><pre>
createdb ome
psql ome
psql>\i /OME/SQL/createOME.sql
psql>\q
</pre></ul>

<li>
create a db user for each user you want to connect</li>

<ul><pre>createuser username</pre></ul>

<li>
put entries into the experimenters table for each user:</li>

<ul>
<pre>
>psql ome
psql>INSERT INTO experimenters (ome_name,firstname,lastname,email) VALUES ('username','John','Doe','jdoe@nowhere.com');
psql>\q
</pre>
</ul>

<li>
The OME front page is OMEanalyze.pl.&nbsp; Point your browser there, and
it will redirect you to a login page (i.e. http://my.ome/server/perl/OMEanalyze.pl).
<br>There is a handy redirect page in OME/src/html, which if put in your Apache server root will redirect the browser to OMEanalyze.pl.
Users who acess the top-level of your server will then be re-directed to OME.

<br>Passwords are currently not checked.&nbsp; There is a javascript RSA
implementation that might do the trick.
<br>Or, if you're behind a firewall, go ahead and send them in the clear,
or leave them disabled, whatever.
<br>Wether or not passwords are checked is decided in ~postgres/pgsql/data/pg_hba.conf</li>
<li>
Once you log in, proceed to import datasets.&nbsp; Only API SoftWorx,
ICCB_TIFF (Universal Imaging) and plain-vanilla single-plane TIFF files are presently supported.</li>

<br>SoftWorx support is in src/perl/OMEDataset/SoftWorx.pm, 
TIFF in src/perl/OMEDataset/TIFF.pm and ICCB_TIFF in src/perl/OMEDataset/ICCB_TIFF.pm.  TIFF datasets are 
single-plane per dataset type of file, while ICCB_TIFF supports multiple wavelengths.
There is a virtual class to serve as an example for general 5-D datasets in src/perl/OMEDataset/OME_XYZWT.pm, 
and a sample implementation of this class in src/perl/OMEDataset/OME_XYZWT/SoftWorx.pm.</ul>

</body>
</html>
